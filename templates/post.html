{% extends 'base.html' %}

{% block header %}
<title>{{ author['first_name'] }} - {{ post['content'][:20] }} | Tacabro</title>
<style>
    .container.context {
        margin-top: 3em !important;
        margin-bottom: 3em !important;
    }
</style>
{% endblock header %}

{% block content %}
<div class="container context">
    <div class="columns">
        <div class="column is-one-fifth">
            {% include "board_list.html" %}
        </div>
        <div class="column">
            <div class="content">
                <div class="box">
                    <article class="media">
                        <div class="media-left">
                            <figure class="image is-64x64">
                                <img src="https://bulma.io/images/placeholders/128x128.png" alt="Image">
                            </figure>
                        </div>
                        <div class="media-content">
                            <div class="content">
                                <p>
                                    <strong>{{ author['first_name'] }}</strong> <small>@{{ author['username'] }}</small> <small>{{ post['publish_date'] }}</small>
                                    <br>
                                    {{ post['content'] }}
                                </p>
                            </div>
                            <br>
                            <!-- icons -->
                            <div class="buttons has-addons columns">
                                <a class="button is-fullwidth is-primary is-outlined column">
                                    <span class="icon is-small">
                                        <i class="fas fa-thumbs-up"></i>
                                    </span>
                                    <span id="like-count">{{ post['like_count'] }}</span>
                                </a>
                                <a class="button is-fullwidth is-danger is-outlined column">
                                    <span class="icon is-small">
                                        <i class="fas fa-thumbs-down"></i>
                                    </span>
                                    <span id="dislike-count">{{ post['dislike_count'] }}</span>
                                </a>
                                <a class="button is-fullwidth is-info is-outlined column" href="#comment-block">
                                    <span class="icon is-small">
                                        <i class="far fa-comment"></i>
                                    </span>
                                    <span id="comment-count">{{ post['comment_count'] }}</span>
                                </a>
                            </div>
                            <!-- /icons -->
                        </div>
                    </article>
                </div>
                <!-- /box -->

                <h1 class="subtitle is-4">留言</h1>
                <div class="box">
                    <div id="comments">
                        {% for comment in comments %}
                        <article class="media">
                            <div class="media-left">
                                <figure class="image is-64x64">
                                    <img src="https://bulma.io/images/placeholders/128x128.png" alt="Image">
                                </figure>
                            </div>
                            <div class="media-content">
                                <div class="content">
                                    <p>
                                        <strong>{{ comment['author_data']['first_name'] }}</strong> <small>@{{ comment['author_data']['username'] }}</small> <small>{{ comment['publish_date'] }}</small>
                                        <br>
                                        {{ comment['content'] }}
                                    </p>
                                </div>
                            </div>
                        </article>
                        {% endfor %}
                    </div>

                    <hr>

                    <article class="media" id="comment-block">
                        <figure class="media-left">
                            <p class="image is-64x64">
                                <img src="https://bulma.io/images/placeholders/128x128.png">
                            </p>
                        </figure>
                        <div class="media-content">
                            <div class="field">
                                <p class="control">
                                    <textarea class="textarea" placeholder="Add a comment..." id="comment-content"></textarea>
                                </p>
                            </div>
                            <div class="field">
                                <p class="control">
                                    <button class="button" id="post-comment">Post comment</button>
                                </p>
                            </div>
                        </div>
                    </article>
                </div>
            </div>
        </div>
    </div>
</div>

{% include "footer.html" %}

<script>
    document.getElementById("post-comment").onclick = () => {
        var user = {
            name: "肥宅",
            id: "ouo",
            img: "https://bulma.io/images/placeholders/128x128.png"
        };
        var commentContent = document.getElementById("comment-content");
        var commentMedia = document.createElement("article");
        commentMedia.className = "media";
        commentMedia.innerHTML = `<div class="media-left">
                                <figure class="image is-64x64">
                                    <img src="${user.img}" alt="Image">
                                </figure>
                            </div>
                            <div class="media-content">
                                <div class="content">
                                    <p>
                                        <strong>${user.name}</strong> <small>@${user.id}</small> <small>${new Date()}</small>
                                        <br>
                                        ${commentContent.value}
                                    </p>
                                </div>
                            </div>`;
        document.getElementById("comments").appendChild(commentMedia);
        document.getElementById("comment-count").innerText = parseInt(document.getElementById("comment-count").innerText) + 1;
        commentContent.value = "";
    }
</script>
{% endblock content %}